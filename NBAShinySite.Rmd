---
title: "NBA Player Data"
output:
  flexdashboard::flex_dashboard:
    theme:
      version: 4
      bootswatch: cyborg
runtime: shiny
---

```{r global, include=FALSE}
knitr::opts_chunk$set(echo = TRUE)
library(tidyverse)
library(hoopR)
library(sportyR)
library(tictoc)
library(ggplot2)
library(janitor)
library(stringr)
library(readr)
mean_shot <- read_csv("mean_shot.csv")
season25 <- read_csv("season25.csv")
```

# About

## Column {data-width = 200}

**Authors**

Noah Jansen and Mitch Thronson

**Background Information**

This project aims to examine some of the player and team statistics for NBA players in the 2024-2025 NBA regular season. While looking at player's game statistics, we also plan to examine their shot map data to identify importance within their shooting.

Player and team data was collected from [Basketball Reference](https://www.basketball-reference.com) and shot data was downloaded via the [hoopR](https://hoopr.sportsdataverse.org) package.

**Github Code**

How did we do it? Check it out [here](https://github.com/Noahmj123/sds264proj).

## Column {data-width = 200}

```{r, echo=FALSE}

renderImage({
    list(src = "nbalogo.png",
         alt = "This is alternate text", width = 600, height = 400)
  })
```

# Shot Distance

```{r, include = FALSE}
tictoc::tic()
progressr::with_progress({
  nba_pbp <- hoopR::load_nba_pbp(seasons = 2025)
})
tictoc::toc()

shot_map <- nba_pbp |>
  filter(shooting_play == "TRUE") |>
  rename(result = scoring_play) |>
  filter(!str_detect(text, "blocks")) |>
  mutate(result = ifelse(result == TRUE, "make", "miss"), player_n = str_extract(text, "^[^ ]+ [^ ]+(?: Jr\\.)?")) |>
  select(player_n, coordinate_x, coordinate_y, result) |>
  filter(player_n %in% season25$player | player_n %in% c("Bogdan Bogdanovic", "Luka Doncic", "Nikola Jokic", "Alperen Sengun", "Dennis Schroder", "Nikola Vucevic", "Nikola JoviÄ‡")) |>
  mutate(coordinate_x = abs(coordinate_x))

shot_map <- shot_map |>
  mutate(x_ft = abs((41.75-coordinate_x)*(15/13.75)), y_ft = abs(coordinate_y)*(15/13.75)) |>
  mutate(shot_dist_ft = sqrt(x_ft^2 + y_ft^2))
```

## Inputs {.sidebar}

```{r, echo=FALSE}
inputPanel(
  selectInput("n_breaks", label = "Number of bins:",
              choices = c(10, 20, 35, 50), selected = 20),
  
  sliderInput("bw_adjust", label = "Bandwidth adjustment:",
              min = 0.2, max = 2, value = 1, step = 0.2)
)
```

## Column

### Geyser Eruption Duration

```{r echo = FALSE}
inputPanel(
  selectInput("distg", label = "Players",
              choices = c("Top 50" = "1:50", "Middle 47" = "51:100", "Bottom 50" = "101:147"), selected = "Top 50")
)

renderTable({
  mean_shot |>
    arrange(-mean_shot_ft) |>
    rename(Player = player_n, "Average Shot(ft)" = mean_shot_ft) |>
    slice(input$distg)
})
```

## Column

### Geyser Eruption Duration

```{r echo = FALSE}
renderPlot({
  ggplot(faithful, aes(x = eruptions)) +
    geom_histogram(aes(y = ..density..), 
                   bins = as.numeric(input$n_breaks2),
                   fill = "white", colour = "black") +
    geom_density(adjust = input$bw_adjust2, colour = "blue") +
    labs(x = "Duration (minutes)", 
         title = "Geyser eruption duration")
})
```

```{r, eval = FALSE, include = FALSE}
# First write code that works, then incorporate into renderPlot
ggplot(faithful, aes(x = eruptions)) +
  geom_histogram(aes(y = ..density..), 
                 bins = 15,
                 fill = "white", colour = "black") +
  geom_density(adjust = 1.2, colour = "blue") +
  labs(x = "Duration (minutes)", 
       title = "Geyser eruption duration")
```

# Efficiency

## Inputs {.sidebar}

```{r, echo=FALSE}
inputPanel(
  selectInput("group_choice", label = "Analyze by:",
              choices = c("Player", "Team"), selected = "Player")
)
```

## Column

### Offensive Efficiency vs. Defensive Efficiency

This will show a scatterplot with each player/team comparing offensive efficiency to defensive efficiency.

# Rank to Record

## Inputs {.sidebar}

```{r, echo=FALSE}
inputPanel(
  selectInput("x_axis", label = "X-axis variable:",
              choices = c("TBD", "Not sure yet.."), selected = "TBD")
)
```

